---
layout: post
date: 2024-02-14
title: Web exploitation at IRMUN
tags: ['vulnerability-writeups']
---

# Hacking IRMUN website

Hi everyone! Iâ€™m Kapil Sareen, *aka **v1p3r***, a wannabe hacker and a member of **@InfoSecIITR**. Today Iâ€™m excited to share what I **HACKED**!

Iâ€™ll walk you through the process of discovering the vulnerability and demonstrate how small mistakes during development can lead to significant consequences.

First, letâ€™s give a shoutout to our sweet little vulnerable target â€” `IRMUN`. The bug was actually in their payment gateway integration, which allowed us to bypass payments entirely and enjoy free accommodations and food, all courtesy of our generous host, `IRMUN`.

![WEBSITE PHOTO](../assets/irmun/before_payment.png)

Alright, letâ€™s dive into the real action!
Weâ€™ll start by making a sample registration to see how we can avail the free goodies. But before proceeding, letâ€™s check the payment status:

![PAYMENT STATUS BEFORE](../assets/irmun/before_payment.png)

As we can see, our **payment status** shows as **incomplete**.  

Letâ€™s attempt to **make a payment** while intercepting the requests using **Burp Suite** to monitor the traffic in real-time. We get redirected to the **payment page**, butâ€¦ wait! Weâ€™re broke. So, letâ€™s **cancel the payment** and return to inspect the backend requests captured by **Burp Suite**.  

One request immediately stands out â€” itâ€™s directed to the endpoint:  
**`/api/payment_failure`**.  

<div style="display: flex; gap: 10px; justify-content: center;">
    <img src="../assets/irmun/failure_request.png" alt="Failure Request" style="max-width: 48%;"/>
    <img src="../assets/irmun/endpoint_discover.png" alt="Endpoint Discovery" style="max-width: 48%;"/>
    </div>



Letâ€™s send this request to **Repeater** and see what itâ€™s up to. Hmmâ€¦ something feels off. The request body contains some peculiar URLs:  

- **`surl=http://irmun.iitr.ac.in/api/payment_failure`**  
- **`furl=http://irmun.iitr.ac.in/api/payment_failure`**  

Could these represent **success URL** and **failure URL**? And why is the request being sent to `/api/payment_failure`?  

Letâ€™s experiment by changing the endpoint to:  
**`/api/payment_success`**  

![Endpoint Change](../assets/irmun/endpoint_change.png)  

Interestingâ€¦ we get a **302 redirect** to `/successful`. Looks like weâ€™ve stumbled upon something promising.  

Now, letâ€™s **drop all pending requests**, refresh the page, and **recheck our payment status**.  

![After Payment](../assets/irmun/after_payment.png)  

#### ğŸ¯ **Voila! The payment is marked as complete.**  

Now we can enjoy all the **free goodies** without spending a dime!  

---

**ğŸ“ PS:** This vulnerability has been **responsibly reported** to and **patched by IRMUN**, so donâ€™t worry â€” this is all **legal stuff**. ğŸ˜‰  